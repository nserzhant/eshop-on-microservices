<mat-card>
  <mat-card-header>
    <mat-card-title>{{ (catalogItem() === null? 'catalog.create-item' : 'catalog.edit-item') | translate }}</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form [formGroup]="editItemForm" (ngSubmit)="onSubmit()">

      <!-- Catalog Item Name -->
      <mat-form-field appearance="outline"class="card-row">
        <mat-label>{{ 'catalog.name' | translate }}</mat-label>
        <input matInput formControlName="name">
        @if (editItemForm.controls['name']?.hasError('required')) {
          <mat-error>
            {{ 'catalog.errors.name-required' | translate }}
          </mat-error>
        }
      </mat-form-field>

      <!-- Brand -->
      <mat-form-field appearance="outline" class="card-row">
        <mat-label>{{ 'catalog.brand' | translate }}</mat-label>
        <mat-select formControlName="brandId">
          @for (brand of catalogBrands(); track brand.id) {
            <mat-option [value]="brand.id">
              {{ brand.brand }}
            </mat-option>
          }
        </mat-select>
        @if (editItemForm.controls['brand']?.hasError('required')) {
          <mat-error>
            {{ 'catalog.errors.brand-required' | translate }}
          </mat-error>
        }
      </mat-form-field>

      <!-- Type -->
      <mat-form-field appearance="outline" class="card-row">
        <mat-label>{{ 'catalog.type' | translate }}</mat-label>
        <mat-select formControlName="typeId">
          @for (type of catalogTypes(); track type.id) {
            <mat-option [value]="type.id">
              {{ type.type }}
            </mat-option>
          }
        </mat-select>
        @if (editItemForm.controls['type']?.hasError('required')) {
          <mat-error>
            {{ 'catalog.errors.type-required' | translate }}
          </mat-error>
        }
      </mat-form-field>

      <!-- Price -->
      <mat-form-field appearance="outline" class="card-row">
        <mat-label>{{ 'catalog.price' | translate }}</mat-label>
        <input type="nummber" matInput formControlName="price">
        @if (editItemForm.controls['price']?.hasError('pattern')) {
          <mat-error>
            {{ 'catalog.errors.price-format' | translate }}
          </mat-error>
        }
      </mat-form-field>

      <!-- Description -->
      <mat-form-field appearance="outline"class="card-row">
        <mat-label>{{ 'catalog.description' | translate }}</mat-label>
        <textarea matInput cdkTextareaAutosize
          cdkAutosizeMinRows="1"
          cdkAutosizeMaxRows="5"
          formControlName="description">
        </textarea>
      </mat-form-field>

      <!-- Image URL -->
      <mat-form-field appearance="outline" class="card-row">
        <mat-label>{{ 'catalog.picture-uri' | translate }}</mat-label>
        <input matInput formControlName="pictureUri" type="url">
      </mat-form-field>

      <!-- Available Qty -->
      <mat-form-field appearance="outline" class="card-row">
        <mat-label>{{ 'catalog.available-qty' | translate }}</mat-label>
        <input type="nummber" matInput formControlName="availableQty">
        @if (editItemForm.controls['availableQty']?.hasError('pattern')) {
          <mat-error>
            {{ 'catalog.errors.qty-should-be-number' | translate }}
          </mat-error>
        }
      </mat-form-field>

      <!-- Save Button -->
      <catalog-api-errors-summary [error]="apiError()"></catalog-api-errors-summary>
      <button type="submit" mat-raised-button color="primary" [disabled]="editItemForm.invalid || isCatalogItemSaving()">
        {{ 'save' | translate }}
      </button>

      <!-- Cancel Button -->
      <button type="button" mat-raised-button color="primary" class="right" (click)="back()">
        {{ 'cancel' | translate }}
      </button>
      @if (isCatalogItemSaving()) {
        <mat-spinner class="action-spinner"></mat-spinner>
      }
    </form>
  </mat-card-content>
</mat-card>
